"use strict";
/**
 * @module @poppinss/prompts
 */
Object.defineProperty(exports, "__esModule", { value: true });
/*
 * @poppinss/prompts
 *
 * (c) Harminder Virk <virk@adonisjs.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */
const events_1 = require("events");
const ObjectBuilder_1 = require("./ObjectBuilder");
/**
 * Base class extended by [[Enquirer]] and [[Emitter]] classes to have
 * common interface.
 */
class Prompt extends events_1.EventEmitter {
    on(event, callback) {
        super.on(event, callback);
        return this;
    }
    /**
     * Prompts for text input
     */
    async ask(title, options) {
        options = options || {};
        const builder = new ObjectBuilder_1.ObjectBuilder();
        builder.addProp('type', 'input');
        builder.addProp('name', options.name);
        builder.addProp('message', title);
        builder.addProp('hint', options.hint);
        builder.addProp('initial', options.default);
        builder.addProp('result', options.result);
        builder.addProp('format', options.format);
        builder.addProp('validate', options.validate);
        return this.prompt(builder.toJSON());
    }
    /**
     * Prompts for text input
     */
    async enum(title, options) {
        options = options || {};
        const builder = new ObjectBuilder_1.ObjectBuilder();
        builder.addProp('type', 'list');
        builder.addProp('sep', options.seperator || ',');
        builder.addProp('name', options.name);
        builder.addProp('message', title);
        builder.addProp('hint', options.hint);
        builder.addProp('initial', options.default);
        builder.addProp('result', options.result);
        builder.addProp('format', options.format);
        builder.addProp('validate', options.validate);
        return this.prompt(builder.toJSON());
    }
    /**
     * Prompts for text input but mangles the output (for password)
     */
    async secure(title, options) {
        options = options || {};
        const builder = new ObjectBuilder_1.ObjectBuilder();
        builder.addProp('type', 'password');
        builder.addProp('name', options.name);
        builder.addProp('message', title);
        builder.addProp('initial', options.default);
        builder.addProp('result', options.result);
        builder.addProp('format', options.format);
        builder.addProp('validate', options.validate);
        return this.prompt(builder.toJSON());
    }
    /**
     * Asks for `Y/n`
     */
    async confirm(title, options) {
        options = options || {};
        const builder = new ObjectBuilder_1.ObjectBuilder();
        builder.addProp('type', 'confirm');
        builder.addProp('name', options.name);
        builder.addProp('message', title);
        builder.addProp('hint', options.hint);
        builder.addProp('initial', options.default);
        builder.addProp('result', options.result);
        builder.addProp('format', options.format);
        builder.addProp('validate', options.validate);
        return this.prompt(builder.toJSON());
    }
    /**
     * Similar to [[this.confirm]] but with custom toggle options
     */
    async toggle(title, choices, options) {
        options = options || {};
        const builder = new ObjectBuilder_1.ObjectBuilder();
        builder.addProp('type', 'toggle');
        builder.addProp('name', options.name);
        builder.addProp('message', title);
        builder.addProp('hint', options.hint);
        builder.addProp('initial', options.default);
        builder.addProp('result', options.result);
        builder.addProp('format', options.format);
        builder.addProp('validate', options.validate);
        builder.addProp('enabled', choices[0]);
        builder.addProp('disabled', choices[1]);
        return this.prompt(builder.toJSON());
    }
    /**
     * Prompts for text input
     */
    async choice(title, choices, options) {
        options = options || {};
        const builder = new ObjectBuilder_1.ObjectBuilder();
        builder.addProp('type', 'select');
        builder.addProp('name', options.name);
        builder.addProp('message', title);
        builder.addProp('initial', options.default);
        builder.addProp('hint', options.hint);
        builder.addProp('result', options.result);
        builder.addProp('format', options.format);
        builder.addProp('validate', options.validate);
        builder.addProp('choices', choices.map((choice) => {
            if (typeof (choice) === 'string') {
                return { name: choice, message: choice, value: choice };
            }
            return choice;
        }));
        return this.prompt(builder.toJSON());
    }
    /**
     * Prompts for text input
     */
    async multiple(title, choices, options) {
        options = options || {};
        const builder = new ObjectBuilder_1.ObjectBuilder();
        builder.addProp('type', 'multiselect');
        builder.addProp('name', options.name);
        builder.addProp('message', title);
        builder.addProp('initial', options.default);
        builder.addProp('result', options.result);
        builder.addProp('format', options.format);
        builder.addProp('hint', options.hint);
        builder.addProp('validate', options.validate);
        builder.addProp('choices', choices.map((choice) => {
            if (typeof (choice) === 'string') {
                return { name: choice, message: choice, value: choice };
            }
            return choice;
        }));
        return this.prompt(builder.toJSON());
    }
    /**
     * Prompts for text input
     */
    async autocomplete(title, choices, options) {
        options = options || {};
        const builder = new ObjectBuilder_1.ObjectBuilder();
        builder.addProp('type', 'autocomplete');
        builder.addProp('name', options.name);
        builder.addProp('message', title);
        builder.addProp('initial', options.default);
        builder.addProp('multiple', options.multiple);
        builder.addProp('result', options.result);
        builder.addProp('hint', options.hint);
        builder.addProp('format', options.format);
        builder.addProp('validate', options.validate);
        builder.addProp('choices', choices);
        return this.prompt(builder.toJSON());
    }
}
exports.Prompt = Prompt;
